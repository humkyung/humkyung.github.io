---
title: 이미지 크기 조절
categories:
  - DEVELOPMENT
tags:
  - 이미지
  - 크기
  - 조정
  - IMAGE
  - SIZE
  - CHANGE
use_math: true
img_path: /assets/images/
---
이미지의 네 점 중 한 점($P_3$)을 이동시켜 크기를 조정하려고 합니다.  

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHkJ0cXKT3YEHFVwNXDOANqrEwlfJ_vTa4MxIuDYKYaz745xqNJCUuonFjGVYV49aD2w-mi0-slt0PLrWwo6CNObdXSVZxJkFNFVpUzjeV4M303jJKAU6aHWgHoBBNGKa8vtLbZvqzSLLN6cbdSjT2Jey1KwTZB_N_uEL3BcEa5YJd18WxYko0hjiE2j8/s600/Pasted%20image%2020240427203012.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHkJ0cXKT3YEHFVwNXDOANqrEwlfJ_vTa4MxIuDYKYaz745xqNJCUuonFjGVYV49aD2w-mi0-slt0PLrWwo6CNObdXSVZxJkFNFVpUzjeV4M303jJKAU6aHWgHoBBNGKa8vtLbZvqzSLLN6cbdSjT2Jey1KwTZB_N_uEL3BcEa5YJd18WxYko0hjiE2j8/s235/Pasted%20image%2020240427203012.png)

여기서 한 가지 조건이 있는데 기존의 X-Y 비율을 지켜야 한다는 것입니다.  
비율은 아래와 같이 정의할 수 있습니다.
$$
ratio = \frac{|\overrightarrow{P_4 - P_3}|}{|\overrightarrow{P_2 - P_1}|}
$$
$P_2$의 $x$ 값을 P의 $x$으로 바꾸고 $length = \overrightarrow{|P_2 - P_1|}$의 길이를 구합니다.  
$P_4$의 y값은 앞서 구한 length에 ratio를 곱하여 구할 수 있습니다.

$$
P_4.y=P_1.y+length∗ratio
$$

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1IFPrqY3j0x6zHpzUkmSTcYxd_9rU1yHvO47ZUdN_D-5_Mt6RcEbRIW3qe_dphhlca9cKi0o14-GelPxqPU1OVf6egoqjQbaCzWPW7rothWBvLa7_-BKOZkDaNXOMjqsgrF9rgu5wWKwy2QsnVp3nZk2i1sAM3Ltw4W9RtDG-mCRncNPwgO3HCvOzzJI/s600/Pasted%20image%2020240427203442.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1IFPrqY3j0x6zHpzUkmSTcYxd_9rU1yHvO47ZUdN_D-5_Mt6RcEbRIW3qe_dphhlca9cKi0o14-GelPxqPU1OVf6egoqjQbaCzWPW7rothWBvLa7_-BKOZkDaNXOMjqsgrF9rgu5wWKwy2QsnVp3nZk2i1sAM3Ltw4W9RtDG-mCRncNPwgO3HCvOzzJI/s327/Pasted%20image%2020240427203442.png)

위에서는 아주 특수한 경우에 대해서 생각을 했었고 우리는 일반적인 경우(회전된 경우 포함)에 대해서 처리해야만 합니다.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi08MUYSguQ17EvrKBktc4yVQmrTEySyuzyxxj-ibEE2U92YQJNxT8_Eu3HgX7PgjPXAUhAjCrK2H7HFahMxUDjClpAhevn6rfm0mj7oumOVErm1HllXq8C6Q7mQ3hlELBQW7RhHxvNAv0teszqbGKwuwwe6dWKX3mqMLaDFIiPMtGzL8BvoGMXmyLN2T4/s600/Pasted%20image%2020240427204109.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi08MUYSguQ17EvrKBktc4yVQmrTEySyuzyxxj-ibEE2U92YQJNxT8_Eu3HgX7PgjPXAUhAjCrK2H7HFahMxUDjClpAhevn6rfm0mj7oumOVErm1HllXq8C6Q7mQ3hlELBQW7RhHxvNAv0teszqbGKwuwwe6dWKX3mqMLaDFIiPMtGzL8BvoGMXmyLN2T4/s386/Pasted%20image%2020240427204109.png)

우선 ${P_2}^\prime$는 아래와 같이 구할 수 있습니다.

$$
\begin{align}
AxisX &= \frac{\overrightarrow{P_2 - P_1}}{\overrightarrow{|P_2 - P_1|}}\\
dot &= AxisX \cdot \overrightarrow{P - P_1}\\
{P_2}^\prime &= P_1 + AxisX * dot\\
\end{align}
$$

그리고 ${P_4}^\prime$는 아래와 같이 구할 수 있습니다.
$$
\begin{align}
AxisY &= \frac{\overrightarrow{P_4 - P_1}}{\overrightarrow{|P_4 - P_1|}}\\
{P_4}^\prime &= P_1 + AxisY * dot*ratio\\
\end{align}
$$
최종적으로 ${P_3}^\prime$는 아래와 같습니다.
$$
{P_3}^\prime = P_1 + AxisX *dot + AxisY * dot * ratio
$$
이로써 기존의 비율을 유지한 채 직사각형의 크기를 바꿀 수 있습니다.  

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh_IGV7vwI88_KXreEDOLkFVnMtYzOxWndmqBF7eSEdVDwoOxqu8GqzBy0e9gvfBuVT6jxPQ8tKOu6-0u9y5i1lbNaWCwGJEV6VMDsLWwECBUCBF0xFZ964Z2x1H0MjdSt9z87FuclxPPwnehVxfmHJ_7caDegXUtJzDSOEadJrUmAbtLRyyTIlDJXh0J4/s600/Pasted%20image%2020240427204523.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh_IGV7vwI88_KXreEDOLkFVnMtYzOxWndmqBF7eSEdVDwoOxqu8GqzBy0e9gvfBuVT6jxPQ8tKOu6-0u9y5i1lbNaWCwGJEV6VMDsLWwECBUCBF0xFZ964Z2x1H0MjdSt9z87FuclxPPwnehVxfmHJ_7caDegXUtJzDSOEadJrUmAbtLRyyTIlDJXh0J4/s372/Pasted%20image%2020240427204523.png)

아래는 샘플 코드입니다. 긴 변을 기준으로 ratio를 구하고 계산하였습니다.

```csharp
/* 움직일 포인터를 구함 */
int idx = (this as IPath).PointSet.FindIndex(x => x.Equals(pt));
 
var OppositeP = (idx + path.PointSet.Count / 2) % path.PointSet.Count;
var PreviousP = (idx + (path.PointSet.Count - 1)) % path.PointSet.Count;
var NextP = (idx + 1) % path.PointSet.Count;
 
var PrevV = path.PointSet[PreviousP] - path.PointSet[OppositeP];
double PrevLength = PrevV.Length;
PrevV.Normalize();
 
var NextV = path.PointSet[NextP] - path.PointSet[OppositeP];
double NextVLength = NextV.Length;
NextV.Normalize();
 
double _dx = P.X - path.PointSet[OppositeP].X;
double _dy = P.Y - path.PointSet[OppositeP].Y;
var dir = new Vector(_dx, _dy);
if (PrevLength > NextVLength)
{
	double ratio = NextVLength / PrevLength;
 
	double dot = MathSet.DotProduct(PrevV.X, PrevV.Y, dir.X, dir.Y);
 
	path.PointSet[PreviousP] = path.PointSet[OppositeP] + PrevV * dot;
	path.PointSet[NextP] = path.PointSet[OppositeP] + NextV * dot * ratio;
	path.PointSet[idx] = path.PointSet[OppositeP] + PrevV * dot + NextV * dot * ratio;
}
else
{
	double ratio = PrevLength / NextVLength;
 
	double dot = MathSet.DotProduct(NextV.X, NextV.Y, dir.X, dir.Y);
 
	path.PointSet[PreviousP] = path.PointSet[OppositeP] + PrevV * dot * ratio;
	path.PointSet[NextP] = path.PointSet[OppositeP] + NextV * dot;
	path.PointSet[idx] = path.PointSet[OppositeP] + PrevV * dot * ratio + NextV * dot;
}
```
![[Pasted image 20260102123751.png]]