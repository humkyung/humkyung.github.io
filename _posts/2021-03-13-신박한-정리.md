---
title: "[리팩토링] 신박한 정리"
categories: [Refactoring]
tags: [Refactoring, 리팩토링, 코딩, 컨벤션]
comments: true 
img_path: /assets/images/Refactoring/
math: true
---

유명한 그리고 한때 유명했던 사람들이 출연하여 자신들의 집을 정리하는 프로그램이 있습니다. 집 정리가 끝난 후 입을 쩍 벌리며 놀라워하는 사람들의 모습이 인상적인 프로그램입니다. 코로나 시국이라 이런 포맷의 프로그램도 등장하는 것 같습니다.

정신없이 프로젝트를 수행하다 보면 우리의 코드도 정리가 필요할 때가 옵니다.

우리도 입이 쩍 벌어질 정도의 깔끔한 코드를 짤 수 있습니다.

아래는 제가 코딩을 하면서 지키는 나름의 가이드입니다.

---

1. 메모리 관리에 신경쓰야 합니다.\
.NET Framework에서 가비지 컬렉션으로 메모리 관리를 하지만 프로그램에서 메모리를 과도하게 낭비하다보면 결국에 OutOfMemoryException을 경험하게 될겁니다.\
![](2021-03-13-1.png)\
위 코드에서 Map은 생성하자마자 쓰레기통에 쳐박히게 됩니다.

2. 멤버 변수의 노출을 최소화합니다.\
멤버 변수를 가지고 외부에서 어떤 일을 할지 몰라 항상 위험이 존재하게 됩니다.\
그리고 멤버 변수를 참조하게 되면 해당 멤버 변수를 수정했을때 참조하는 코드도 수정해야 합니다. 즉 결합도가 증가됩니다.\
<code style="background:yellow">결합도는 줄이고 응집도는 높여야 좋은 코드가 됩니다.</code>\
따라서 메서드를 만들어 클래스에게 일을 시키는 방향으로 코드를 작성하는 것이 좋습니다.\
<code style="color:red">데이터를 받아 일을 하는게 아니라 일을 위임하여 서비스를 받는다고 생각하면 될것 같습니다.</code>

3. 오류가 노출되게 합니다.\
가끔씩 오류가 발생할 가능성이 있는 부분 혹은 디버깅시 오류가 발생한 곳에 try/catch로 감싸놓은 코드를 볼 수가 있습니다.\
이런 부분의 프로그램의 잠재적 위험이 됩니다. 프로그램이 죽지 않을뿐 우리가 원하지 않은 다른 결과를 얻게 됩니다. 그리고 점점더 위험한 프로그램을 만들게 됩니다.\
오히려 우리의 예상과 다른 결과를 얻었을때 오류를 발생시키는 것이 좋습니다.
```c#
/// <summary> /// start에서 end로 가는 최소 비용의 경로를 구한다 /// </summary>
/// <param name="start"></param> 
/// <param name="oEnds"></param>
/// <returns>첫 번째 요소: 성공 경로, 두 번째 요소: 실패 경로</returns>
private List<Path> FindShortestPath(Node start, List<Node> oEnds)
```
위 함수는 출발점에서 종료 지점까지 가는 최단 거리를 구합니다.
우리 프로그램에서는 최단 거리는 하나여야 하기 때문에 그렇지 않을 경우에는 오류를 발생시킵니다.
```c#
throw new InvalidOperationException("2개 이상의 경로가 목적지에 도착했습니다.");
```

4. 클래스나 함수에 주석을 답니다.\
클래스나 함수가 하는 일을 정의하고 내용을 주석에 달아 놓고 구현을 하는 것이 좋습니다.\
그래야 구현 시 앞서 정의한 내용 외의 것들이 추가되는 것을 방지할 수 있습니다.\
누가 될지 모르지만 불쌍한 인수인계자에게 조금의 도움이 됩니다.

5. 함수는 하나의 일만 하도록 합니다.\
하나의 함수가 여러가지 일을 하는 멀티 플레이어 함수 보다는 하나의 일을 하는 여러 함수들을 사용하는 것이 좋습니다.

6. 메서드의 내용은 한 화면에 다 보일 정도의 양이면 좋습니다.\
코드 사이에 왜 빈 줄들을 많이 넣는지 이유를 모르겠습니다.

7. 매직 넘버는 없습니다.\
가끔씩 코드를 보면 특별한 숫자들이 존재합니다. 이 숫자들은 대부분 **<code style="color:blue">"이 정도 값이면 되지 않을까?"</code>**라는 의미를 가집니다.\
위험하고 이러한 코드를 보면 거부감이 들어야 합니다.\
옵션 처리가 가능하면 옵션으로 빼야 합니다.\
![](2021-03-13-2.png)

8. 코딩 컨벤션을 지킵니다.\
우리의 프로젝트가 현재 .NET 월드에 있기때문에 .NET 코딩 컨벤션을 지키는게 좋습니다.\
마킹한 함수 이름은 자바스럽습니다.\
![](2021-03-13-3.png)\
Java는 Java 스타일, Python은 Python 스타일을 지키는게 좋습니다.\
<code style="background:yellow;color:black">더 중요한 것은 한 프로젝트에서는 동일한 컨벤션을 가져야 한다는 것입니다.</code>

9. 변수는 사용되는 위치에서 가까운 곳에 선언합니다.\
한 눈에 코드 파악이 쉬워집니다.\
![](2021-03-13-4.png)
위 코드보다 아래가 더 보기 쉬운것 같습니다.\
![](2021-03-13-5.png)

10. 멤버 변수와 지역 변수를 구분하기 쉽게 합니다.\
<code style="color:blue">this</code>를 붙이면 로컬 변수와 멤버 변수를 쉽게 구별할 수 있습니다.\
이건 제 개인적인 취향입니다.